# FrontEnd - 쿠키(Cookie)

## 설명

### 1. 쿠키 정의

- 클라이언트가 어떠한 웹사이트에 방문할 경우, 그 사이트가 사용하고 있는 서버를 통해 클라이언트의 브라우저에 설치되는 작은 기록 정보 파일을 일컫습니다.
- 쿠키는 사용자의 로컬에 `key`, `value` 형태로 저장되는 데이터 파일입니다.
- 쿠키에는 이름,값,만료시간,경로 정보 등이 담겨있습니다.
- 쿠키는 4KB의 용량 제한이 있고 서버 요청마다 서버로 쿠키가 전송됩니다.
- 쿠키는 세션쿠키(Session Cookie)와 지속적쿠키(Persistent Cookie)로 나눠집니다.

#### 1-1. 세션 쿠키(Session Cookie)

만료시간을 지정하지 않으면 데이터는 Session Cookie에 저장됩니다. 브라우저나 탭이 열려있는 동안에만 저장되므로 브라우저가 닫히면 쿠키는 삭제됩니다.

#### 1-2. 지속적 쿠키(Persistent Cookie)

만료시간을 지정했을 때 Persistent Cookie에 저장되며 만료되기 전까지 사용자의 Local에 저장되고 만료일이 지나면 삭제됩니다.

### 2. 쿠키 인증 방식

- 서버는 클라이언트의 로그인 요청에 대한 응답을 작성할 때, 클라이언트 측에 저장하고 싶은 정보를 응답 헤더의 Set-Cookie에 담습니다.
- 이후 해당 클라이언트는 요청을 보낼 때마다, 매번 저장된 쿠키를 요청 헤더의 Cookie에 담아 보냅니다.
- 서버는 쿠키에 담긴 정보를 바탕으로 해당 요청의 클라이언트가 누군지 식별할 수 있습니다.
- 요청시 쿠키의 값을 그대로 보내기 때문에 보안에 취약합니다.
- 쿠키에는 용량 제한이 있어 많은 정보를 담을 수 없습니다.
- 웹 브라우저마다 쿠키에 대한 지원 형태가 다르기 때문에 브라우저간 공유가 불가능합니다.

### 3. 쿠키/세션 인증 방식

#### 3-1. 인증 방식 순서

- 사용자가 로그인을 합니다.
- 서버에서는 계정정보를 읽어 사용자를 확인한 후에 사용자의 고유한 ID 값을 부여하여 세션 저장소에 저장한 후, 이와 연결되는 세션 ID를 발행합니다.
  - 세션ID를 쿠키라고 봐도 됩니다. 쿠키가 사용자 개념에서는 더 큰 범주입니다.
- 사용자는 서버에서 해당 세션 ID를 받아 쿠키에 저장을 한 후, 인증이 필요한 요청마다 쿠키를 헤더에 실어 보냅니다.
- 서버에서는 쿠키를 받아 세션 저장소에서 대조를 한 후 대응되는 정보를 가져옵니다.
- 인증이 완료되고 서버는 사용자에 맞는 데이터를 보내줍니다.

#### 3-2. 장점

- 쿠키가 담긴 HTTP 요청이 도중에 노출되더라도 쿠키 자체는 유의미한 값을 갖고 있지 않기 때문에 JWT 방식 보다는 안전합니다.
- 일일이 회원정보를 확인할 필요가 없이 바로 어떤 회원인지 확인할 수 있어서 서버의 자원에 접근하기 용이합니다.

#### 3-3. 단점

- 쿠키 탈취 자체는 안전하지만, 만약에 HTTP 요청을 해커가 가로챈다면 그 안에 있는 쿠키를 가로채서 HTTP 요청을 보낼 수 있습니다(하이재킹).
  - HTTPS 를 사용하고 세션에 유효기간을 넣어주어야 합니다.
- 서버에서 세션 저장소를 사용하므로 추가적인 저장공간이 필요합니다.

## 요약

- 쿠키
  - 쿠키는 웹 페이지를 방문하면, 자신의 이름을 쿠키에 저장 가능합니다.
  - 하나의 도메인 당 20개의를 가질 수 있고, 클라이언트에 총 300개의 쿠키를 저장할 수 있습니다.
  - 쿠키는 서버측에서 만료 날짜를 지정하여 정해진 시간 동안 데이터(상태 정보를)유지할 수 있습니다.
  - 즉, 브라우저가 닫혀도 지속적 쿠키로 인해 쿠키는 유지됩니다.
  - 쿠키의 사용 사례로는 **자동 로그인, 팝업** 등이 있습니다.

## 참고

- 쿠키와 세션의 차이 [→(BLOG)](https://jeong-pro.tistory.com/80)
